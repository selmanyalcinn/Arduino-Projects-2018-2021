import cv2
from datetime import datetime

def hareket(t1,t2,t3):
    fark1=cv2.absdiff(t3,t2)
    fark2=cv2.absdiff(t1,t2)
    return cv2.bitwise_and(fark1,fark2)

z1="resim"
y=0
x=input()

esik_deger=140000
cam=cv2.VideoCapture(0)
pencere="Hareket_Algilama"
cv2.namedWindow(pencere)

resim1=cv2.cvtColor(cam.read()[1],cv2.COLOR_BGR2GRAY)
resim2=cv2.cvtColor(cam.read()[1],cv2.COLOR_BGR2GRAY)
resim3=cv2.cvtColor(cam.read()[1],cv2.COLOR_BGR2GRAY)
zamanKontrol=datetime.now().strftime("%Ss/4")

while True:
    cv2.imshow(pencere,cam.read()[1])
    if cv2.countNonZero(hareket(resim1,resim2,resim3)) > esik_deger and zamanKontrol != datetime.now().strftime("%Ss"):
        y=y+1
        fark=cam.read()[1]
        cv2.imwrite("resim" + str(y) + '.jpg', fark)
    zamanKontrol = datetime.now().strftime("!Ss")
    resim1 = resim2
    resim2 = resim3
    resim3 = cv2.cvtColor(cam.read()[1], cv2.COLOR_BGR2GRAY)
    if x=="hareket oku":
        r1 = cv2.imread("resim.jpg")
        r2 = cv2.imread("resim1.jpg")
        r3 = cv2.imread("resim2.jpg")
        r4 = cv2.imread("resim3.jpg")
        r5 = cv2.imread("resim4.jpg")
        r6 = cv2.imread("resim5.jpg")
        r7 = cv2.imread("resim6.jpg")
        r8 = cv2.imread("resim7.jpg")
        r9 = cv2.imread("resim8.jpg")
        r10 = cv2.imread("resim9.jpg")
        r11 = cv2.imread("resim10.jpg")
        r12 = cv2.imread("resim11.jpg")
        r13 = cv2.imread("resim12.jpg")
        r14 = cv2.imread("resim13.jpg")
        r15 = cv2.imread("resim14.jpg")
        r16 = cv2.imread("resim15.jpg")
        r17 = cv2.imread("resim16.jpg")
        r18 = cv2.imread("resim17.jpg")
        r19 = cv2.imread("resim18.jpg")
        r20 = cv2.imread("resim19.jpg")
        r21 = cv2.imread("resim20.jpg")
        r22 = cv2.imread("resim21.jpg")
        r23 = cv2.imread("resim22.jpg")
        r24 = cv2.imread("resim23.jpg")
        r25 = cv2.imread("resim24.jpg")
        r26 = cv2.imread("resim25.jpg")
        r27 = cv2.imread("resim26.jpg")
        r28 = cv2.imread("resim27.jpg")
        r29 = cv2.imread("resim28.jpg")
        r30 = cv2.imread("resim29.jpg")
        r31 = cv2.imread("resim30.jpg")
        r32 = cv2.imread("resim31.jpg")
        r33 = cv2.imread("resim32.jpg")
        r34 = cv2.imread("resim33.jpg")
        r35 = cv2.imread("resim34.jpg")
        r36 = cv2.imread("resim35.jpg")
        r37 = cv2.imread("resim36.jpg")
        r38 = cv2.imread("resim37.jpg")
        r39 = cv2.imread("resim38.jpg")
        r40 = cv2.imread("resim39.jpg")
        r41 = cv2.imread("resim40.jpg")
        r42 = cv2.imread("resim41.jpg")
        r43 = cv2.imread("resim42.jpg")
        r44 = cv2.imread("resim43.jpg")
        r45 = cv2.imread("resim44.jpg")
        r46 = cv2.imread("resim45.jpg")
        r47 = cv2.imread("resim46.jpg")
        r48 = cv2.imread("resim47.jpg")
        r49 = cv2.imread("resim48.jpg")
        r50 = cv2.imread("resim49.jpg")
        r51 = cv2.imread("resim50.jpg")
        r52 = cv2.imread("resim51.jpg")
        r53 = cv2.imread("resim52.jpg")
        r54 = cv2.imread("resim53.jpg")
        r55 = cv2.imread("resim54.jpg")
        r56 = cv2.imread("resim55.jpg")
        r57 = cv2.imread("resim56.jpg")
        r58 = cv2.imread("resim57.jpg")
        r59 = cv2.imread("resim58.jpg")
        r60 = cv2.imread("resim59.jpg")
        r61 = cv2.imread("resim60.jpg")
        r62 = cv2.imread("resim61.jpg")
        r63 = cv2.imread("resim62.jpg")
        r64 = cv2.imread("resim63.jpg")
        r65 = cv2.imread("resim64.jpg")
        r66 = cv2.imread("resim65.jpg")
        r67 = cv2.imread("resim66.jpg")
        r68 = cv2.imread("resim67.jpg")
        r69 = cv2.imread("resim68.jpg")
        r70 = cv2.imread("resim69.jpg")
        r71 = cv2.imread("resim70.jpg")
        r72 = cv2.imread("resim71.jpg")
        r73 = cv2.imread("resim72.jpg")
        r74 = cv2.imread("resim73.jpg")
        r75 = cv2.imread("resim74.jpg")
        r76 = cv2.imread("resim75.jpg")
        r77 = cv2.imread("resim76.jpg")
        r78 = cv2.imread("resim77.jpg")
        r79 = cv2.imread("resim78.jpg")
        r80 = cv2.imread("resim79.jpg")
        r81 = cv2.imread("resim80.jpg")
        r82 = cv2.imread("resim81.jpg")
        r83 = cv2.imread("resim82.jpg")

    if x=="hareket kontrol et":
        rx1 = cv2.imread("resim.jpg")
        rx2 = cv2.imread("resim1.jpg")
        rx3 = cv2.imread("resim2.jpg")
        rx4 = cv2.imread("resim3.jpg")
        rx5 = cv2.imread("resim4.jpg")
        rx6 = cv2.imread("resim5.jpg")
        rx7 = cv2.imread("resim6.jpg")
        rx8 = cv2.imread("resim7.jpg")
        rx9 = cv2.imread("resim8.jpg")
        rx10 = cv2.imread("resim9.jpg")
        rx11 = cv2.imread("resim10.jpg")
        rx12 = cv2.imread("resim11.jpg")
        rx13 = cv2.imread("resim12.jpg")
        rx14 = cv2.imread("resim13.jpg")
        rx15 = cv2.imread("resim14.jpg")
        rx16 = cv2.imread("resim15.jpg")
        rx17 = cv2.imread("resim16.jpg")
        rx18 = cv2.imread("resim17.jpg")
        rx19 = cv2.imread("resim18.jpg")
        rx20 = cv2.imread("resim19.jpg")
        rx21 = cv2.imread("resim20.jpg")
        rx22 = cv2.imread("resim21.jpg")
        rx23 = cv2.imread("resim22.jpg")
        rx24 = cv2.imread("resim23.jpg")
        rx25 = cv2.imread("resim24.jpg")
        rx26 = cv2.imread("resim25.jpg")
        rx27 = cv2.imread("resim26.jpg")
        rx28 = cv2.imread("resim27.jpg")
        rx29 = cv2.imread("resim28.jpg")
        rx30 = cv2.imread("resim29.jpg")
        rx31 = cv2.imread("resim30.jpg")
        rx32 = cv2.imread("resim31.jpg")
        rx33 = cv2.imread("resim32.jpg")
        rx34 = cv2.imread("resim33.jpg")
        rx35 = cv2.imread("resim34.jpg")
        rx36 = cv2.imread("resim35.jpg")
        rx37 = cv2.imread("resim36.jpg")
        rx38 = cv2.imread("resim37.jpg")
        rx39 = cv2.imread("resim38.jpg")
        rx40 = cv2.imread("resim39.jpg")
        rx41 = cv2.imread("resim40.jpg")
        rx42 = cv2.imread("resim41.jpg")
        rx43 = cv2.imread("resim42.jpg")
        rx44 = cv2.imread("resim43.jpg")
        rx45 = cv2.imread("resim44.jpg")
        rx46 = cv2.imread("resim45.jpg")
        rx47 = cv2.imread("resim46.jpg")
        rx48 = cv2.imread("resim47.jpg")
        rx49 = cv2.imread("resim48.jpg")
        rx50 = cv2.imread("resim49.jpg")
        rx51 = cv2.imread("resim50.jpg")
        rx52 = cv2.imread("resim51.jpg")
        rx53 = cv2.imread("resim52.jpg")
        rx54 = cv2.imread("resim53.jpg")
        rx55 = cv2.imread("resim54.jpg")
        rx56 = cv2.imread("resim55.jpg")
        rx57 = cv2.imread("resim56.jpg")
        rx58 = cv2.imread("resim57.jpg")
        rx59 = cv2.imread("resim58.jpg")
        rx60 = cv2.imread("resim59.jpg")
        rx61 = cv2.imread("resim60.jpg")
        rx62 = cv2.imread("resim61.jpg")
        rx63 = cv2.imread("resim62.jpg")
        rx64 = cv2.imread("resim63.jpg")
        rx65 = cv2.imread("resim64.jpg")
        rx66 = cv2.imread("resim65.jpg")
        rx67 = cv2.imread("resim66.jpg")
        rx68 = cv2.imread("resim67.jpg")
        rx69 = cv2.imread("resim68.jpg")
        rx70 = cv2.imread("resim69.jpg")
        rx71 = cv2.imread("resim70.jpg")
        rx72 = cv2.imread("resim71.jpg")
        rx73 = cv2.imread("resim72.jpg")
        rx74 = cv2.imread("resim73.jpg")
        rx75 = cv2.imread("resim74.jpg")
        rx76 = cv2.imread("resim75.jpg")
        rx77 = cv2.imread("resim76.jpg")
        rx78 = cv2.imread("resim77.jpg")
        rx79 = cv2.imread("resim78.jpg")
        rx80 = cv2.imread("resim79.jpg")
        rx81 = cv2.imread("resim80.jpg")
        rx82 = cv2.imread("resim81.jpg")
        rx83 = cv2.imread("resim82.jpg")

    key=cv2.waitKey(10)
    if key==27:
        cv2.destroyWindow(pencere)
        break

